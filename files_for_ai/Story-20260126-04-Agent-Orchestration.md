# Story-20260126-04: Agent (智能体) 编排与多角色协作

## 1. 痛点分析
复杂的任务（如开发一个功能、策划一场营销活动）往往无法通过单一的 Prompt 完成。目前用户必须在多个会话、多个 Prompt 之间手动传递中间结果，效率低下且容易出错。我们需要一种机制来串联多个“专家型 AI”（Agents），实现自动化协作。

## 2. 核心需求

### 2.1 Agent 实体定义 (Agent Profiling)
- **需求**：允许用户创建具有特定身份、知识和工具的 AI 角色。
- **功能点**：
    - **人设配置**：定义 System Instruction、语气风格等。
    - **能力挂载**：为 Agent 绑定特定的 Skill 组和 RAG 知识库。
    - **长期记忆 (Memory)**：支持为 Agent 开启长期记忆，记录以往的交互决策。

### 2.2 工作流可视化编辑器 (Visual Workflow Builder)
- **需求**：通过图形化界面定义多个 Agent 之间的任务传递逻辑。
- **功能点**：
    - **节点类型**：Agent 节点、逻辑判断节点、人工审批节点。
    - **数据流传递**：定义上一个 Agent 的输出如何映射到下一个 Agent 的输入。
    - **串行/并行执行**：支持多个 Agent 同时执行任务并汇总结果。

### 2.3 协作会话窗口 (Collaborative Chat)
- **需求**：在一个会话中召唤多个 Agent 共同解决问题。
- **功能点**：
    - **显式召唤**：通过 `@AgentName` 强制指派某个 Agent 回答。
    - **自动路由**：系统根据任务内容，自动调度最合适的 Agent（如：代码问题分配给 "Coder", 文案问题分配给 "Writer"）。
    - 协作记录：清晰展示每个 Agent 的贡献路径。

## 3. 用户场景示例
- **场景**：全自动自媒体内容创作。
- **流程**：
    1. **Agent 1 (热点挖掘)**：使用网络搜索工具找寻今日热门话题。
    2. **Agent 2 (文案策划)**：基于热点编写 3 个不同风格的脚本。
    3. **用户节点**：用户在界面中选择其中 1 个脚本并点击“批准”。
    4. **Agent 3 (排版美化)**：将选中的脚本转换为适配小红书或微博的格式，并自动添加标签。
    5. **Agent 4 (图像生成)**：自动生成配图提示词并调用绘图工具生成封面图。
