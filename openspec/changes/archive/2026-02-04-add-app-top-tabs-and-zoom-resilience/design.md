# Design: 顶级标签页与缩放抗乱序

## Context

- 当前应用主布局为：左侧可拖拽宽度的 TemplatesSidebar（模板列表 + 发现/编辑入口 + MCP/市场等按钮）+ 中间主内容（编辑器或“选择模板”）。MCP 资源中心（McpManager）与提示词市场（MarketView）以全屏覆盖层/弹窗形式展示。
- 需求为：将「提示词管理」「MCP 中心」「提示词市场」提升为顶级标签，左侧竖向排列；同时解决页面缩放时关键区域排版混乱问题。

## Goals / Non-Goals

- **Goals**
  - 三个顶级标签在左侧竖向排列，点击切换主内容区，现有功能均可用。
  - 关键 UI 在浏览器/系统缩放时具备最小可读性与可点性，不出现严重换行错乱。
- **Non-Goals**
  - 不改变 MCP 或市场业务逻辑与 API；不新增或删除功能特性。
  - 不强制支持极端缩放比例（如 50% 或 200%），以常见 80%–125% 为优先。

## Decisions

1. **顶级标签栏形态**
   - 在根布局最左侧增加固定宽度（如 56–72px）的竖向标签栏，仅图标 + 可选短文案（或 tooltip），三个标签对应：提示词管理、MCP 中心、提示词市场。当前选中的标签高亮。
   - 主内容区根据当前标签渲染：标签一 = 现有「侧栏 + 发现/编辑」整体；标签二 = McpManager 全内容（可带顶部返回/关闭）；标签三 = MarketView 全内容（同上）。TemplatesSidebar 仅在「提示词管理」标签下出现。

2. **MCP / 市场入口迁移**
   - TemplatesSidebar 顶部的 MCP、提示词市场按钮移除或改为“快捷跳转”（切换顶级标签并选中对应 tab），避免重复入口。具体以“保留功能、不重复弹窗”为原则。

3. **缩放抗乱序策略**
   - **关键区域**：顶级标签栏、TemplatesSidebar 标题与主要按钮、编辑器工具栏、主列表项文字、弹窗标题与主要按钮。
   - **手段**：对上述区域使用 CSS 最小约束，例如：
     - 字体：`font-size: clamp(12px, 1rem, 14px)` 或 `min-font-size`（若项目支持）或统一使用 `min-height` 保证点击区域；
     - 容器：侧栏、标签栏、工具栏设置 `min-width`/`min-height`，避免被压缩到不可用；
     - 图标按钮：统一最小触摸/点击区域（如 44px）与图标最小尺寸。
   - 不引入全局 `zoom` 或 `transform: scale` 修复，仅通过约束关键元素尺寸与字号保证可读可点。

4. **响应式与移动端**
   - 移动端若已有底部 TabBar（如 MobileTabBar），可与顶级标签语义对齐（例如底部 tab 与左侧顶级标签一一对应），或保留现有移动布局、仅桌面端使用左侧竖向标签。本变更以桌面布局为主，移动端不强制在本阶段改动。

## Risks / Trade-offs

- **左侧占宽**：多一列标签栏会略减主内容宽度，可通过收窄标签栏（仅图标）与可拖拽侧栏平衡。
- **缩放边界**：极端缩放下仍可能溢出，通过限定“常见缩放范围”与最小尺寸降低风险，不做 100% 兼容承诺。

## Migration Plan

- 无数据迁移。部署后用户刷新即可看到新布局；若保留“上次选中标签”的持久化，可用 localStorage 或现有设置存储，可选实现。

## Open Questions

- 无。若后续需要“记住上次打开的标签”，可在实现阶段在现有持久化中增加一项即可。
